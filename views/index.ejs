<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>Document</title>
</head>

<body>
	<h3> Path:
		<%= path %>
	</h3>

	<!-- <form action="POST" action="" onsubmit="return testPost();" method="POST"> -->
	<form action="" onsubmit="return testPost();" method="POST">
		Name:
		<input type="text" name='fname'>
		<input type="submit" value="POST">
	</form>

	<!-- <form action="" onsubmit="return testGet();">
		Name:
		<input type="text" name='fname'>
		<input type="submit" value="GET">
	</form> -->

	<button onclick="testPost()">POST</button>
	<button onclick="testGet()">GET</button>
	<button onclick="testGet()">PUT</button>
	<button onclick="testPost()">DELETE</button>
	
	<div></div>
	<script>
		function testPost() {
			let xhr = new XMLHttpRequest();
			xhr.open('post', '/contact', true);
			xhr.setRequestHeader("Content-type", "application/json");
			xhr.onload = function () { }
			let data = JSON.stringify({ firstname: 'Jane', lastname: 'Doer' });
			xhr.onreadystatechange = function () {
				console.log(this.readyState);
				if (this.readyState == 4 && this.status == 200) {
					document.querySelector('div').innerHTML = xhr.responseText;
					// console.log('allHeaders: ', xhr.getAllResponseHeaders());
					console.log('responseText: \n\n', xhr.responseText);
				}

			}
			xhr.send(data);
			// console.log(req);
			return false;
		}


		function testGet() {

			let xhr = new XMLHttpRequest();

			xhr.open('get', '/contacts', true);
			xhr.setRequestHeader("Content-type", "text/html");

			xhr.onreadystatechange = function () {
				// Process the server response here.
				// console.log('allHeaders: ', xhr.getAllResponseHeaders());

				if (this.readyState == 4 && this.status == 200) {
					document.querySelector('div').innerHTML = xhr.responseText;
					// console.log('responseText: ', xhr.responseText);
					// console.log(typeof this.readyState, this.status);
					// console.log('responseText: ', xhr);
				}

			}
			// xhr.onload = function () { }
			// let data = JSON.stringify({ firstname: 'Jane', lastname: 'Doer' });
			// xhr.send(data);

			xhr.send();
			return false;
		}
	</script>

</body>

</html>


<!-- 
	I want to have a button for each of my verbs

 -->
<!-- 
	onsubmint='return somefunction();'
	https://stackoverflow.com/questions/5195933/with-form-validation-why-onsubmit-return-functionname-instead-of-onsubmit
 -->